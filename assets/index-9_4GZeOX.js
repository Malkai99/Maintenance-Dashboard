import{j as e,r as u,R as I}from"./react-L_ukdsnw.js";import{c as L}from"./react-dom-50bK44qw.js";import{D as R}from"./react-chartjs-2-o_NvxRvI.js";import{S as F}from"./react-slick-zyv5WSLU.js";/* empty css                       */import{F as T}from"./react-icons-LqCbCNTM.js";import{C as q,A as z,p as B,a as _}from"./chart.js-uyaxlqz9.js";import{u as k,Q as W,a as U,R as Q}from"./@tanstack-Ej_z1fdq.js";import{e as G}from"./date-fns-zXfHFL24.js";import{e as K}from"./react-datepicker-DFLYum_3.js";import{r as V}from"./react-responsive-b9SflI7d.js";import"./classnames-Qe22oBeS.js";import"./scheduler-iwWdm5Ml.js";import"./lodash.debounce-5mBl9nYv.js";import"./resize-observer-polyfill-802KOfsG.js";import"./json2mq-hkdWEevq.js";import"./string-convert-NV8PTOlN.js";import"./enquire.js-6Qlgqrhw.js";import"./@kurkle-sRCxMDZz.js";import"./@babel-blHd5-vz.js";import"./react-onclickoutside-urJW6kcO.js";import"./react-popper-CogaYvqk.js";import"./react-fast-compare-55LePW81.js";import"./@popperjs-zyV4rJhQ.js";import"./warning-tq1HNrfO.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();const H=({title:t,subtitle:s,value:a})=>{const i={plugins:{legend:{display:!1},tooltip:{enabled:!1}},responsive:!0,maintainAspectRatio:!1,aspectRatio:2,layout:{padding:40}},r={labels:[t,s],datasets:[{label:"Efectividad",data:[a,100-a],backgroundColor:["#598234","#2B2B36"],borderColor:["#598234","#2B2B36"],borderWidth:1,circumference:180,rotation:270,cutout:"75%"}]},o={id:"gaugePointer",afterDatasetsDraw(n,d,f){const{ctx:l,data:c}=n,p=n.getDatasetMeta(0).data[0].x,m=n.getDatasetMeta(0).data[0].y,h=n.getDatasetMeta(0).data[0].outerRadius,b=n.getDatasetMeta(0).data[0].innerRadius,y=h-b,w=h-b+y,j=0-h-y/2,C=Math.PI/180,x=6,g=n.getDatasetMeta(0).data[0].$context.raw;function E(v){return v.reduce((N,S)=>N+S,0)}const $=c.datasets[0].data.map((v,N)=>v),M=E($),A=g/M*100,O=g/M*180-90;l.save(),l.translate(p,m),l.rotate(C*O),l.beginPath(),l.fillStyle="#598234",l.roundRect(0-x/2,j,x,w,5),l.fill(),l.restore();function P(){const S=30*(n.chartArea.width/n.chartArea.height);return S>60?60:S}l.font=`bold ${P()}px Inter sans-serif`,l.fillStyle="black",l.textAlign="center",l.textBaseline="bottom",l.fillText(`${A.toFixed(0)}%`,p,m)}};return e.jsxs("div",{className:"card__container block w-full px-8 py-5 max-w-full 2xl:max-w-[100%] lg:max-w-[600px] lg:max-h-[350px] max-h-80  h-[350px] 2xl:max-h-96 bg-white rounded-2xl shadow-cardShadow ",children:[e.jsx("h3",{className:"font-roboto font-bold w-full text-2xl md:text-3xl xl:text-4xl text-grey-text select-none",children:t}),e.jsx("div",{className:"relative block h-full w-[99%]",children:e.jsx(R,{options:i,data:r,plugins:[o]})})]})},J=({children:t})=>{const s={dots:!0,arrows:!0,infinite:!1,speed:500,slidesToShow:1,slidesToScroll:1};return e.jsx(F,{...s,children:t})},X=({closeModal:t,title:s,children:a})=>{const i={buttonStyles:"focus:outline-0  text-blue-button border-blue-button hover:border-blue-button border bg-transparent border-opacity-40 hover:border-opacity-100 hover:bg-blue-button hover:bg-opacity-[.05]",transitionStyle:"transition-bg button-ease duration-200"};return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-10",children:[e.jsx("div",{className:"absolute inset-0 bg-black  opacity-50",onClick:t}),e.jsxs("div",{className:"z-20 bg-white p-8 w-[90%] max-w-[500px] rounded-lg shadow-cardShadow flex flex-col",children:[s&&e.jsx("h3",{className:"text-xl font-semibold mb-4",children:s}),a,t&&e.jsx("button",{className:`mt-8 ${i.buttonStyles} ${i.transitionStyle}`,onClick:t,children:"Cerrar"})]})]})},Y=({text:t,children:s})=>{const[a,i]=u.useState(!1),r=u.useRef(null),o=u.useRef(null),n=l=>{a||i(!0)},d=()=>{a&&i(!1)},f=l=>{r.current&&!r.current.contains(l.target)&&o.current&&!o.current.contains(l.target)&&i(!1)};return u.useEffect(()=>(document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}),[]),e.jsxs("div",{className:"relative inline-block",children:[e.jsx("span",{ref:o,onClick:n,className:`${a?"cursor-pointer":"cursor-default"}`,children:s}),a&&e.jsx("div",{ref:r,onClick:d,className:` cursor-pointer select-none absolute z-10 bg-black text-white p-2 rounded-md -left-2 top-full text-sm sm:text-base max-w-[200px] lg:max-w-[300px] lg:w-[300px] w-[200px] transition-all duration-300 ease-in-out ${a?"opacity-100 transform scale-100":"opacity-0 transform scale-95"}`,children:t})]})},Z=({machines:t})=>{const[s,a]=u.useState(!1),[i,r]=u.useState(null),o=c=>c?"text-green-success":"text-red-alert",n=c=>({true:"Activo",false:"Inactivo"})[c],d=c=>{c.isActive||(a(!0),r(c.requests))},f=()=>{a(!1),r(null)},l=()=>i.map((c,p)=>e.jsxs(u.Fragment,{children:[e.jsxs("p",{children:["Folio: ",c.folio]}),e.jsxs("p",{children:["Status: ",c.status]}),e.jsxs("p",{children:["Departamento: ",c.department]}),e.jsxs("p",{children:["Tiempo transcurrido: ",c.elapsedTime]})]},p));return e.jsxs("div",{className:"font-roboto 2xl:max--[100%] lg:max-w-[100%] lg:max-h-[350px] h-[350px] card__container block w-full pl-8 py-5 max-w-full max-h-80 2xl:max-h-96 bg-white rounded-2xl shadow-cardShadow ",children:[e.jsxs("h3",{className:"font-roboto font-bold w-full text-2xl md:text-3xl xl:text-4xl text-grey-text flex ",children:[e.jsx("p",{className:"select-none",children:"Maquinas"}),e.jsx(Y,{text:"Haz clic en la máquina 'Inactiva' para más detalles.",children:e.jsx(T,{style:{marginLeft:"5px",cursor:"pointer",width:"20px"},title:"Más información"})})]}),e.jsx("ul",{className:"h-[80%] flex flex-col overflow-y-auto pr-5 sm:pr-[10%] mt-3",children:t.map((c,p)=>e.jsxs("li",{className:"relative flex justify-between items-center flex-wrap h-auto w-full my-5",children:[e.jsx("p",{className:"cursor-default select-none",children:c.name}),e.jsx("p",{onClick:()=>d(c),className:`${c&&c.isActive==!1?"cursor-pointer":"cursor-default"} select-none ${o(c.isActive)} `,children:n(c.isActive)})]},p))}),s&&i&&e.jsx(X,{title:"Información de la máquina",closeModal:f,children:e.jsx(J,{children:l()})})]})},ee=({title:t,qty:s})=>e.jsxs("div",{className:"flex flex-col items-center md:w-[280px] w-[80%] h-[150px] p-[25px] justify-center bg-white rounded-2xl shadow-cardShadow my-5 md:my-0 ",children:[e.jsx("p",{className:"font-roboto font-semibold text-6xl select-none",children:s}),e.jsx("h2",{className:"font-roboto font-bold text-3xl select-none",children:t})]});q.register(z,B,_);const te=({title:t,value:s})=>{const a=n=>{const d={Disponibilidad:"#3498DB",Rendimiento:"#B30000",Calidad:"#FFC029",default:"#598234"};return d[n]||d.default},i={plugins:{legend:{display:!1},tooltip:{enabled:!1,mode:"dataset"}},responsive:!0,maintainAspectRatio:!1,aspectRatio:1,layout:{padding:20}},r={labels:["OEE","Waste"],datasets:[{label:"Effectiveness",data:[s,100-s],backgroundColor:[a(t),"#E2E2E2"],borderColor:[a(t),"#E2E2E2"],borderWidth:1,rotation:90,cutout:"85%"}]},o={id:"gaugePointer",afterDatasetsDraw(n){const{ctx:d}=n,f=n.getDatasetMeta(0).data[0].x,l=n.getDatasetMeta(0).data[0].y;function c(){const h=52*(n.chartArea.width/n.chartArea.height);return h>60?60:h}d.font=`bold ${c()}px Inter sans-serif`,d.fillStyle=a(t),d.textAlign="center",d.textBaseline="middle",d.fillText(`${s}%`,f,l)}};return e.jsxs("div",{className:"card__container block w-full px-8 py-5 max-w-full 2xl:max-w-[100%] lg:max-w-[600px] lg:max-h-[350px] max-h-80  h-[350px] 2xl:max-h-96 bg-white rounded-2xl shadow-cardShadow ",children:[e.jsx("h3",{className:"font-roboto font-bold w-full text-2xl md:text-3xl xl:text-4xl text-grey-text select-none ",children:t}),e.jsx("div",{className:"relative block h-[90%] w-[99%]",children:e.jsx(R,{options:i,data:r,plugins:[o]})})]})},se=async(t,s,a)=>{const i="https://andonapi.azurewebsites.net",r=new URLSearchParams({productId:t,shift:s,date:a});return await(await fetch(`${i}/api/cells/dashboard?${r}`)).json()},re=(t,s,a)=>k({queryKey:["dashboard",t,s,a],queryFn:()=>se(t,s,a)}),oe=()=>e.jsxs("div",{className:"flex items-center justify-center h-screen select-none",children:[e.jsx("div",{className:"animate-spin rounded-full border-t-2 border-blue-500 border-t-blue-500 h-12 w-12"}),e.jsx("span",{className:"ml-4 text-blue-500 font-semibold text-xl",children:"Cargando..."})]}),ne=()=>{const{data:t,isLoading:s,isError:a,isFetching:i,refetch:r}=re(1,2,"02/06/2024"),{machines:o=[{}],metrics:n=[{}],production:d}=t||{},f={gridStyles:"dashboard__container block relative w-full h-auto grid gap-6 xl:grid-cols-3 xl:grid-rows-2 md:grid-cols-2 sm:grid-cols-1 sm:grid-auto-rows-auto",marginStyles:"lg:px-20 md:px-10 px-5 my-10 pb-12",buttonStyles:"focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-blue-500 hover:border-blue-500"};if(s||i)return e.jsx(oe,{});if(a)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center text-red-600 font-bold p-8 border border-red-600 bg-red-100 rounded-md max-w-md",children:[e.jsx("p",{className:"mb-4",children:"Error al cargar los datos. Inténtalo de nuevo más tarde."}),e.jsx("button",{className:` ${f.buttonStyles} bg-blue-500 text-black px-4 py-2 rounded-md shadow-md border border-blue-700`,onClick:r,children:"Volver a intentar"})]})});const l={doughnut:te,gauge:H},c=(m,h)=>{const b=l[m.type];return b?e.jsx(b,{value:m.value,title:m.title,subtitle:m.subtitle},`${m.type}-${h}`):(console.warn(`Unknown metric type: ${m.type}`),null)},p=m=>{if(m&&typeof m=="object")return Object.entries(m).map(([h,b])=>e.jsx(ee,{title:h,qty:b},h));console.warn("Invalid production data format")};return e.jsxs("div",{className:`${f.gridStyles} my-10 pb-12 md:pb-0`,children:[e.jsx("div",{className:"flex flex-col justify-between items-center 2xl:max-h-[350px]",children:d&&p(d)}),o&&e.jsx(Z,{machines:o}),n&&Array.isArray(n)&&n.map(c)]})},ae=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:15,height:16,fill:"none",...t,children:e.jsx("path",{stroke:"#151D48",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m3.997 6 3.51 4 3.51-4"})}),D=({options:t,isFilterEnable:s})=>{const[a,i]=u.useState([]),[r,o]=u.useState(!1),[n,d]=u.useState(""),f=u.useRef(null),l=u.useRef(null),c=u.useRef(null),p={fontStyles:"font-roboto font-bold text-dark-charcoal text-sm sm:text-xl",buttonStyles:"focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-blue-500 hover:border-blue-500"},m=()=>{if(t){const x=t.find(g=>g.isSelected);i(x||null)}};u.useEffect(()=>{t&&Array.isArray(t)&&m()},[t]),u.useEffect(()=>{const x=g=>{f.current&&l.current&&!f.current.contains(g.target)&&!l.current.contains(g.target)&&(j(),o(!1),w())};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[]);const h=()=>{o(!r)},b=x=>{d(x.target.value.toLowerCase())},y=x=>{i(x),w(),j(),h()},w=()=>{l.current&&(l.current.scrollTop=0)},j=()=>{d(""),c.current&&(c.current.value="")},C=u.useCallback(()=>Array.isArray(t)?s?t.filter(x=>x.text.toLowerCase().includes(n.toLowerCase())):t:[],[n,s]);return e.jsxs("div",{className:`relative group w-[100%] h-[100%] ${p.fontStyles}`,children:[e.jsxs("button",{ref:f,onClick:h,readOnly:!0,className:`relative h-full flex justify-center items-center w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-xl shadow-cardShadow hover:border-blue-button ${p.buttonStyles}`,children:[e.jsx("span",{className:`mr-2 ${p.fontStyles} `,children:a.text}),e.jsx(ae,{className:"absolute right-[10%]"})]}),e.jsxs("div",{ref:l,className:`${r?"":"hidden"} absolute right-0 mt-2 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 p-1 space-y-1 z-10 w-full max-h-[200px] overflow-y-auto ${p.fontStyles} `,children:[s&&e.jsx("input",{ref:c,className:`block w-full px-4 py-2 text-gray-800 font-normal focus:outline-none ${s?"active":"hidden"}`,type:"text",placeholder:"Buscar...",autoComplete:"on",onChange:b}),t&&C().map((x,g)=>e.jsx("option",{value:x.value,onClick:()=>y(x),className:"font-normal block px-4 py-2 text-gray-700 hover:bg-gray-100 active:bg-blue-100 cursor-pointer rounded-md",children:x.text},g))]})]})},le=async()=>await(await fetch("https://andonapi.azurewebsites.net/api/shift/select")).json(),ce=()=>k({queryKey:["shifts"],queryFn:()=>le(),refetchOnWindowFocus:!1,onError:s=>{console.error("Error en la consulta de celdas:",s)}}),ie=async()=>await(await fetch("https://andonapi.azurewebsites.net/api/product/select/plc")).json(),de=()=>k({queryKey:["cells"],queryFn:()=>ie(),refetchOnWindowFocus:!1,onError:s=>{console.error("Error en la consulta de celdas:",s)}}),ue=()=>{const[t,s]=u.useState(new Date),a=V.useMediaQuery({maxWidth:768}),{data:i}=ce(),{data:r}=de(),o={cardStyles:"flex items-center justify-center bg-white rounded-xl shadow-cardShadow ",buttonStyles:"flex items-center justify-center bg-transparent  w-[200px] h-[50px]",fontStyles:"font-roboto font-bold text-dark-charcoal text-sm sm:text-xl md:text-base lg:text-xl",marginStyles:"px-0 sm:px-5 py-5 ",dateStyles:"select-none focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-blue-button hover:border-blue-button hover:border"};function n(f){s(f)}const d=u.forwardRef(({value:f,onClick:l},c)=>e.jsx("button",{className:`w-full h-full bg-white rounded-xl datepicker-input text-center cursor-pointer ${o.dateStyles}`,onClick:l,ref:c,readOnly:!0,children:f}));return e.jsxs("div",{className:"relative flex justify-center w-full h-auto mt-[30px]",children:[e.jsx("div",{className:"w-1/3 h-full flex justify-start",children:e.jsx("div",{className:`${o.fontStyles} ${o.buttonStyles} `,children:e.jsx(D,{options:r,isFilterEnable:!0})})}),e.jsx("div",{className:"w-1/3 h-full flex justify-center mx-2 md:mx-0",children:e.jsx("div",{className:` ${o.fontStyles} w-[200px] h-[50px]`,children:e.jsx(D,{options:i,isFilterEnable:!1})})}),e.jsx("div",{className:"w-1/3 h-full flex justify-end",children:e.jsx("div",{className:`datepicker-container ${o.cardStyles} ${o.fontStyles} p-0 w-[100%] xl:w-[80%] h-[50px]`,children:e.jsx(K,{selected:t,onChange:n,dateFormat:a?"dd MMMM":"EEEE dd MMMM yyyy",locale:G,maxDate:new Date,customInput:e.jsx(d,{})})})})]})},fe=new W;function xe(){const[t,s]=u.useState(!1);return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,u.useEffect(()=>{const a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;s(a)},[]),e.jsxs(U,{client:fe,children:[e.jsx("div",{className:`App w-full  xl:h-screen flex flex-col bg-white-smoke ${t?"theme-dark":"theme-light"}`,children:e.jsxs("section",{className:" block relative w-full h-full lg:px-20 md:px-10 px-5",children:[e.jsx(ue,{}),e.jsx(ne,{})]})}),e.jsx(Q,{})]})}L.createRoot(document.getElementById("root")).render(e.jsx(I.StrictMode,{children:e.jsx(xe,{})}));
